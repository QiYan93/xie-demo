#!/usr/bin/env node
'use strict';

var program = require('commander');
var fs = require('fs');

program
    .option('new [name]', '新建小程序组件文件')
    .version(require('../package.json').version)
    .parse(process.argv); 

var option = process.argv[2];

if(option === 'new'){
    var name = process.argv[3];
    if(name) {
        newData(name);
        console.log('新建成功!');
        return;
    }else {
        console.log('请输入文件名, new [name]')
    }
}else{
    program.help();
}


function newData(name){
    var fs = require("fs");
    var _dirname = process.cwd();
    var text = [
            `/* ${name}.js */`,
            '{}',
            `<!-- ${name}.wxml -->`,
            `/* ${name}.wxss */`
        ];
    var suffix = ['.js', '.json', '.wxml', '.wxss'];
    if(!fs.existsSync(_dirname+'/'+name)){
        fs.mkdirSync(name);
    }
    for(var i = 0;i < 4;i++) {
        fs.writeFile(_dirname+'/'+name+'/'+name+suffix[i], text[i] ,  function(err) {
            if (err) {
                return console.error(err);
            }
         });
    }
}